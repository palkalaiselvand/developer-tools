@page "/guidhelpers"
@using System.Globalization
@using System.Linq
@inject IJSRuntime JSRuntime

<div class="max-w-screen-xl mx-auto space-y-8">
    <div>
        <h1 class="text-3xl font-bold text-gray-800">GUID Utilities</h1>
        <p class="text-gray-600 mt-2">
            Generate GUIDs in multiple formats, create identifiers from numeric values, and break down existing GUIDs
            into their numeric components. All operations run locally in your browser.
        </p>
    </div>

    <section class="bg-white rounded-lg shadow-md overflow-hidden">
        <header class="border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-800">Single GUID generator</h2>
        </header>
        <div class="p-6 space-y-6">
            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label for="guid-format" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                        Format
                    </label>
                    <select id="guid-format"
                            @bind="SelectedFormat"
                            class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                        <option value="@GuidFormatOption.Hyphenated">32 digits with hyphens (D)</option>
                        <option value="@GuidFormatOption.DigitsOnly">32 digits (N)</option>
                        <option value="@GuidFormatOption.Braces">Braces (B)</option>
                        <option value="@GuidFormatOption.Parentheses">Parentheses (P)</option>
                        <option value="@GuidFormatOption.Hexadecimal">Hexadecimal struct (X)</option>
                    </select>
                </div>
                <div class="flex items-center gap-3">
                    <label class="inline-flex items-center gap-2 text-sm text-gray-700 pt-6 md:pt-0">
                        <input type="checkbox" @bind="UppercaseGuid" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" />
                        Uppercase letters
                    </label>
                    <button @onclick="GenerateGuid"
                            class="ml-auto px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                        New GUID
                    </button>
                </div>
                <div class="text-sm text-gray-500 flex flex-col justify-center">
                    <span class="font-semibold text-gray-700 uppercase tracking-wide">Metadata</span>
                    <span>Version: @GuidVersionLabel</span>
                    <span>Variant: @GuidVariantLabel</span>
                </div>
            </div>

            <div class="relative">
                <label class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">Value</label>
                <textarea class="w-full p-3 border border-gray-300 rounded-md bg-gray-50 font-mono text-sm"
                          rows="2"
                          readonly>@NewGuidText</textarea>
                <div class="absolute right-2 top-2 flex items-center gap-2">
                    <button @onclick="CopyNewGuid"
                            id="copy-guid-btn"
                            class="text-gray-500 hover:text-gray-700"
                            title="Copy GUID">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                        </svg>
                    </button>
                    <button @onclick="CopyNewGuidBase64"
                            id="copy-guid-base64-btn"
                            class="text-gray-500 hover:text-gray-700"
                            title="Copy Base64">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 12h14M12 5l7 7-7 7" />
                        </svg>
                    </button>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-sm">
                <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                    <span class="block text-xs uppercase text-gray-500 font-semibold">Base64</span>
                    <span class="block font-mono break-all">@NewGuidBase64</span>
                </div>
                <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                    <span class="block text-xs uppercase text-gray-500 font-semibold">Big integer</span>
                    <span class="block font-mono break-all">@NewGuidBigInteger</span>
                </div>
                <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                    <span class="block text-xs uppercase text-gray-500 font-semibold">SQL binary literal</span>
                    <span class="block font-mono break-all">@NewGuidSqlLiteral</span>
                </div>
            </div>
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md overflow-hidden">
        <header class="border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-800">Bulk generator</h2>
        </header>
        <div class="p-6 space-y-5">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label for="bulk-count" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                        Count (1 â€“ 200)
                    </label>
                    <input id="bulk-count"
                           type="number"
                           min="1"
                           max="200"
                           @bind="BulkGuidCount"
                           class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500" />
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1" for="bulk-format">
                        Format
                    </label>
                    <select id="bulk-format"
                            @bind="BulkFormat"
                            class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                        <option value="@GuidFormatOption.Hyphenated">Hyphenated (D)</option>
                        <option value="@GuidFormatOption.DigitsOnly">Digits only (N)</option>
                        <option value="@GuidFormatOption.Braces">Braces (B)</option>
                        <option value="@GuidFormatOption.Parentheses">Parentheses (P)</option>
                        <option value="@GuidFormatOption.Hexadecimal">Hexadecimal (X)</option>
                    </select>
                </div>
                <div class="flex items-center gap-3">
                    <label class="inline-flex items-center gap-2 text-sm text-gray-700 pt-6 md:pt-0">
                        <input type="checkbox" @bind="BulkUppercase" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" />
                        Uppercase letters
                    </label>
                </div>
                <div class="flex items-center gap-3">
                    <label class="inline-flex items-center gap-2 text-sm text-gray-700 pt-6 md:pt-0">
                        <input type="checkbox" @bind="BulkIncludeBase64" class="rounded border-gray-300 text-blue-600 focus:ring-blue-500" />
                        Include Base64 column
                    </label>
                </div>
            </div>

            <div class="flex flex-wrap gap-3">
                <button @onclick="GenerateBulkGuids"
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                    Generate list
                </button>
                <button @onclick="CopyBulkGuids"
                        id="copy-bulk-guid-btn"
                        class="px-4 py-2 bg-gray-100 text-gray-700 rounded-md hover:bg-gray-200 transition-colors">
                    Copy list
                </button>
            </div>

            <textarea class="w-full h-48 p-3 border border-gray-300 rounded-md bg-gray-50 font-mono text-sm"
                      readonly>@BulkGuidOutput</textarea>
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md overflow-hidden">
        <header class="border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-800">Build GUID from numeric values</h2>
        </header>
        <div class="p-6 space-y-5">
            <div class="grid grid-cols-1 md:grid-cols-4 gap-4">
                <div>
                    <label for="longInput" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                        64-bit value
                    </label>
                    <input type="text" @bind="LongInput" id="longInput"
                           class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           placeholder="e.g. 8753021195070865403 or 0x798e..." />
                </div>
                <div>
                    <label for="intInput" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                        32-bit value
                    </label>
                    <input type="text" @bind="IntInput" id="intInput"
                           class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                           placeholder="e.g. 241199884 or 0x0E5E..." />
                </div>
                <div>
                    <label for="byte-order" class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                        Byte order
                    </label>
                    <select id="byte-order"
                            @bind="NumericByteOrder"
                            class="w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 text-sm">
                        <option value="@GuidByteOrder.LittleEndian">Little endian (default)</option>
                        <option value="@GuidByteOrder.BigEndian">Big endian</option>
                    </select>
                </div>
                <div class="flex items-end">
                    <button @onclick="GuidFromLongAndInt"
                            class="w-full px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                        Generate GUID
                    </button>
                </div>
            </div>

            @if (!string.IsNullOrWhiteSpace(LongIntConversionError))
            {
                <div class="rounded-md bg-red-50 border border-red-200 text-red-700 text-sm px-3 py-2">
                    @LongIntConversionError
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(LongIntToGuidResult))
            {
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="relative">
                        <label class="block text-sm font-semibold text-gray-700 uppercase tracking-wide mb-1">
                            GUID (@SelectedFormatLabel)
                        </label>
                        <textarea class="w-full p-3 border border-gray-300 rounded-md bg-gray-50 font-mono text-sm"
                                  rows="2"
                                  readonly>@LongIntToGuidResult</textarea>
                        <button @onclick="CopyLongIntResult"
                                id="copy-longint-result-btn"
                                class="absolute right-2 top-2 text-gray-500 hover:text-gray-700"
                                title="Copy GUID">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 16H6a2 2 0 01-2-2V6a2 2 0 012-2h8a2 2 0 012 2v2m-6 12h8a2 2 0 002-2v-8a2 2 0 00-2-2h-8a2 2 0 00-2 2v8a2 2 0 002 2z" />
                            </svg>
                        </button>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                        <span class="block text-xs uppercase text-gray-500 font-semibold">Base64</span>
                        <span class="block font-mono break-all">@LongIntToGuidBase64</span>
                    </div>
                </div>
            }
        </div>
    </section>

    <section class="bg-white rounded-lg shadow-md overflow-hidden">
        <header class="border-b border-gray-200 px-6 py-4">
            <h2 class="text-lg font-semibold text-gray-800">Decompose existing GUID</h2>
        </header>
        <div class="p-6 space-y-5">
            <div class="flex flex-col md:flex-row gap-4">
                <input type="text"
                       @bind="Section3GuidInput"
                       class="flex-1 border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500"
                       placeholder="Paste any GUID format or Base64 value" />
                <button @onclick="SplitGuidToLongAndInt"
                        class="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 transition-colors">
                    Analyse
                </button>
            </div>

            @if (!string.IsNullOrWhiteSpace(SplitError))
            {
                <div class="rounded-md bg-red-50 border border-red-200 text-red-700 text-sm px-3 py-2">
                    @SplitError
                </div>
            }

            @if (!string.IsNullOrWhiteSpace(Section3Base64))
            {
                <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                        <span class="block text-xs uppercase text-gray-500 font-semibold">Normalised GUID (D)</span>
                        <span class="block font-mono break-all">@Section3Normalized</span>
                    </div>
                    <div class="bg-gray-50 border border-gray-200 rounded-md p-3">
                        <span class="block text-xs uppercase text-gray-500 font-semibold">Base64</span>
                        <span class="block font-mono break-all">@Section3Base64</span>
                    </div>
                </div>
                <div class="overflow-auto border border-gray-200 rounded-lg">
                    <table class="min-w-full text-sm">
                        <thead class="bg-gray-50 text-gray-700 uppercase tracking-wide text-xs">
                            <tr>
                                <th class="px-4 py-2 text-left">Byte order</th>
                                <th class="px-4 py-2 text-left">Int64</th>
                                <th class="px-4 py-2 text-left">Int32</th>
                                <th class="px-4 py-2 text-left">Actions</th>
                            </tr>
                        </thead>
                        <tbody class="divide-y divide-gray-200">
                            <tr>
                                <td class="px-4 py-2 font-semibold text-gray-700">Little endian</td>
                                <td class="px-4 py-2 font-mono">@Section3LongResultLittle</td>
                                <td class="px-4 py-2 font-mono">@Section3IntResultLittle</td>
                                <td class="px-4 py-2">
                                    <div class="flex gap-2">
                                        <button @onclick="CopyLongResultLittle"
                                                id="copy-long-result-btn"
                                                class="text-gray-500 hover:text-gray-700"
                                                title="Copy long">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                        <button @onclick="CopyIntResultLittle"
                                                id="copy-int-result-btn"
                                                class="text-gray-500 hover:text-gray-700"
                                                title="Copy int">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                            <tr>
                                <td class="px-4 py-2 font-semibold text-gray-700">Big endian</td>
                                <td class="px-4 py-2 font-mono">@Section3LongResultBig</td>
                                <td class="px-4 py-2 font-mono">@Section3IntResultBig</td>
                                <td class="px-4 py-2">
                                    <div class="flex gap-2">
                                        <button @onclick="CopyLongResultBig"
                                                id="copy-long-result-big-btn"
                                                class="text-gray-500 hover:text-gray-700"
                                                title="Copy long">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                        <button @onclick="CopyIntResultBig"
                                                id="copy-int-result-big-btn"
                                                class="text-gray-500 hover:text-gray-700"
                                                title="Copy int">
                                            <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 5H6a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2v-1M8 5a2 2 0 002 2h2a2 2 0 002-2M8 5a2 2 0 012-2h2a2 2 0 012 2m0 0h2a2 2 0 012 2v3m2 4H10m0 0l3-3m-3 3l3 3" />
                                            </svg>
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            }
        </div>
    </section>
</div>

@code {
    private Guid currentGuid = Guid.NewGuid();
    private GuidFormatOption selectedFormat = GuidFormatOption.Hyphenated;
    private bool uppercaseGuid = true;
    private string? NewGuidText { get; set; }
    private string? NewGuidBase64 { get; set; }
    private string? NewGuidBigInteger { get; set; }
    private string? NewGuidSqlLiteral { get; set; }
    private string? GuidVersionLabel { get; set; }
    private string? GuidVariantLabel { get; set; }

    private int BulkGuidCount { get; set; } = 10;
    private GuidFormatOption bulkFormat = GuidFormatOption.Hyphenated;
    private bool BulkUppercase { get; set; } = true;
    private bool BulkIncludeBase64 { get; set; }
    private string? BulkGuidOutput { get; set; }

    private string? LongInput { get; set; }
    private string? IntInput { get; set; }
    private GuidByteOrder NumericByteOrder { get; set; } = GuidByteOrder.LittleEndian;
    private string? LongIntToGuidResult { get; set; }
    private string? LongIntToGuidBase64 { get; set; }
    private string? LongIntConversionError { get; set; }

    private string? Section3GuidInput { get; set; }
    private string? Section3Normalized { get; set; }
    private string? Section3Base64 { get; set; }
    private string? Section3LongResultLittle { get; set; }
    private string? Section3IntResultLittle { get; set; }
    private string? Section3LongResultBig { get; set; }
    private string? Section3IntResultBig { get; set; }
    private string? SplitError { get; set; }

    private GuidFormatOption BulkFormat
    {
        get => bulkFormat;
        set => bulkFormat = value;
    }

    private GuidFormatOption SelectedFormat
    {
        get => selectedFormat;
        set
        {
            if (selectedFormat != value)
            {
                selectedFormat = value;
                UpdateGuidRepresentations();
            }
        }
    }

    private bool UppercaseGuid
    {
        get => uppercaseGuid;
        set
        {
            if (uppercaseGuid != value)
            {
                uppercaseGuid = value;
                UpdateGuidRepresentations();
            }
        }
    }

    private string SelectedFormatLabel => SelectedFormat switch
    {
        GuidFormatOption.Hyphenated => "D",
        GuidFormatOption.DigitsOnly => "N",
        GuidFormatOption.Braces => "B",
        GuidFormatOption.Parentheses => "P",
        GuidFormatOption.Hexadecimal => "X",
        _ => "D"
    };

    protected override void OnInitialized()
    {
        UpdateGuidRepresentations();
    }

    private void GenerateGuid()
    {
        currentGuid = Guid.NewGuid();
        UpdateGuidRepresentations();
    }

    private void UpdateGuidRepresentations()
    {
        NewGuidText = FormatGuid(currentGuid, SelectedFormat, UppercaseGuid);
        NewGuidBase64 = Convert.ToBase64String(currentGuid.ToByteArray());
        NewGuidBigInteger = new System.Numerics.BigInteger(currentGuid.ToByteArray().Concat(new byte[] { 0 }).ToArray()).ToString(CultureInfo.InvariantCulture);
        NewGuidSqlLiteral = "0x" + BitConverter.ToString(currentGuid.ToByteArray()).Replace("-", string.Empty);
        GuidVersionLabel = $"V{GetGuidVersion(currentGuid)}";
        GuidVariantLabel = GetGuidVariant(currentGuid);
    }

    private void GenerateBulkGuids()
    {
        var count = Math.Clamp(BulkGuidCount, 1, 200);
        var builder = new System.Text.StringBuilder();

        for (var i = 0; i < count; i++)
        {
            var value = Guid.NewGuid();
            var formatted = FormatGuid(value, BulkFormat, BulkUppercase);
            if (BulkIncludeBase64)
            {
                builder.Append(formatted)
                       .Append('\t')
                       .Append(Convert.ToBase64String(value.ToByteArray()));
            }
            else
            {
                builder.Append(formatted);
            }

            if (i < count - 1)
            {
                builder.AppendLine();
            }
        }

        BulkGuidOutput = builder.ToString();
        BulkGuidCount = count;
    }

    private string FormatGuid(Guid value, GuidFormatOption format, bool uppercase)
    {
        var specifier = format switch
        {
            GuidFormatOption.Hyphenated => "D",
            GuidFormatOption.DigitsOnly => "N",
            GuidFormatOption.Braces => "B",
            GuidFormatOption.Parentheses => "P",
            GuidFormatOption.Hexadecimal => "X",
            _ => "D"
        };

        var formatted = value.ToString(specifier);
        return uppercase ? formatted.ToUpperInvariant() : formatted;
    }

    private void GuidFromLongAndInt()
    {
        LongIntConversionError = null;
        LongIntToGuidResult = null;
        LongIntToGuidBase64 = null;

        if (!TryParseInt64(LongInput, out var parsedLong) || !TryParseInt32(IntInput, out var parsedInt))
        {
            LongIntConversionError = "Provide valid numeric inputs (decimal or 0x-prefixed hexadecimal).";
            return;
        }

        var bytes = new byte[16];
        var longBytes = BitConverter.GetBytes(parsedLong);
        var intBytes = BitConverter.GetBytes(parsedInt);

        if (NumericByteOrder == GuidByteOrder.BigEndian)
        {
            Array.Reverse(longBytes);
            Array.Reverse(intBytes);
        }

        Array.Copy(longBytes, 0, bytes, 0, longBytes.Length);
        Array.Copy(intBytes, 0, bytes, 12, intBytes.Length);

        var guid = new Guid(bytes);
        LongIntToGuidResult = FormatGuid(guid, SelectedFormat, UppercaseGuid);
        LongIntToGuidBase64 = Convert.ToBase64String(bytes);
    }

    private void SplitGuidToLongAndInt()
    {
        SplitError = null;
        Section3Normalized = null;
        Section3Base64 = null;
        Section3LongResultLittle = null;
        Section3IntResultLittle = null;
        Section3LongResultBig = null;
        Section3IntResultBig = null;

        if (string.IsNullOrWhiteSpace(Section3GuidInput))
        {
            SplitError = "Enter a GUID or Base64 string.";
            return;
        }

        var input = Section3GuidInput.Trim();
        Guid guid;

        if (Guid.TryParse(input, out var parsedGuid))
        {
            guid = parsedGuid;
        }
        else
        {
            // Attempt Base64 decoding
            try
            {
                var bytes = Convert.FromBase64String(input);
                if (bytes.Length != 16)
                {
                    SplitError = "Base64 input must decode to exactly 16 bytes.";
                    return;
                }
                guid = new Guid(bytes);
            }
            catch (FormatException)
            {
                SplitError = "Unable to parse the value as a GUID or Base64 string.";
                return;
            }
        }

        var littleEndianBytes = guid.ToByteArray();
        var bigEndianBytes = (byte[])littleEndianBytes.Clone();
        Array.Reverse(bigEndianBytes, 0, 8);
        Array.Reverse(bigEndianBytes, 12, 4);

        Section3Normalized = guid.ToString("D").ToUpperInvariant();
        Section3Base64 = Convert.ToBase64String(littleEndianBytes);
        Section3LongResultLittle = BitConverter.ToInt64(littleEndianBytes, 0).ToString(CultureInfo.InvariantCulture);
        Section3IntResultLittle = BitConverter.ToInt32(littleEndianBytes, 12).ToString(CultureInfo.InvariantCulture);
        Section3LongResultBig = BitConverter.ToInt64(bigEndianBytes, 0).ToString(CultureInfo.InvariantCulture);
        Section3IntResultBig = BitConverter.ToInt32(bigEndianBytes, 12).ToString(CultureInfo.InvariantCulture);
    }

    private string GetGuidVariant(Guid guid)
    {
        var bytes = guid.ToByteArray();
        var variant = (bytes[8] & 0xE0) >> 5;
        return variant switch
        {
            0b000 => "Reserved (NCS)",
            0b100 => "RFC 4122",
            0b110 => "Reserved (Microsoft)",
            0b111 => "Reserved (future)",
            _ => "Unknown"
        };
    }

    private int GetGuidVersion(Guid guid)
    {
        var bytes = guid.ToByteArray();
        return (bytes[7] >> 4) & 0x0F;
    }

    private static bool TryParseInt64(string? input, out long value)
    {
        value = 0;
        if (string.IsNullOrWhiteSpace(input))
        {
            return false;
        }

        var trimmed = input.Trim();
        if (trimmed.StartsWith("0x", StringComparison.OrdinalIgnoreCase))
        {
            return long.TryParse(trimmed[2..], NumberStyles.AllowHexSpecifier, CultureInfo.InvariantCulture, out value);
        }

        return long.TryParse(trimmed, NumberStyles.Integer, CultureInfo.InvariantCulture, out value);
    }

    private static bool TryParseInt32(string? input, out int value)
    {
        value = 0;
        if (string.IsNullOrWhiteSpace(input))
        {
            return false;
        }

        var trimmed = input.Trim();
        if (trimmed.StartsWith("0x", StringComparison.OrdinalIgnoreCase))
        {
            return int.TryParse(trimmed[2..], NumberStyles.AllowHexSpecifier, CultureInfo.InvariantCulture, out value);
        }

        return int.TryParse(trimmed, NumberStyles.Integer, CultureInfo.InvariantCulture, out value);
    }

    private async Task CopyNewGuid()
    {
        if (!string.IsNullOrEmpty(NewGuidText))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", NewGuidText, "copy-guid-btn");
        }
    }

    private async Task CopyNewGuidBase64()
    {
        if (!string.IsNullOrEmpty(NewGuidBase64))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", NewGuidBase64, "copy-guid-base64-btn");
        }
    }

    private async Task CopyBulkGuids()
    {
        if (!string.IsNullOrEmpty(BulkGuidOutput))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", BulkGuidOutput, "copy-bulk-guid-btn");
        }
    }

    private async Task CopyLongIntResult()
    {
        if (!string.IsNullOrEmpty(LongIntToGuidResult))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", LongIntToGuidResult, "copy-longint-result-btn");
        }
    }

    private async Task CopyLongResultLittle()
    {
        if (!string.IsNullOrEmpty(Section3LongResultLittle))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", Section3LongResultLittle, "copy-long-result-btn");
        }
    }

    private async Task CopyIntResultLittle()
    {
        if (!string.IsNullOrEmpty(Section3IntResultLittle))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", Section3IntResultLittle, "copy-int-result-btn");
        }
    }

    private async Task CopyLongResultBig()
    {
        if (!string.IsNullOrEmpty(Section3LongResultBig))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", Section3LongResultBig, "copy-long-result-big-btn");
        }
    }

    private async Task CopyIntResultBig()
    {
        if (!string.IsNullOrEmpty(Section3IntResultBig))
        {
            await JSRuntime.InvokeVoidAsync("copyToClipboard", Section3IntResultBig, "copy-int-result-big-btn");
        }
    }

    private enum GuidFormatOption
    {
        Hyphenated,
        DigitsOnly,
        Braces,
        Parentheses,
        Hexadecimal
    }

    private enum GuidByteOrder
    {
        LittleEndian,
        BigEndian
    }
}
